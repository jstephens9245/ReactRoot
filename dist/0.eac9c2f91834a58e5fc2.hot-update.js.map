{"version":3,"sources":["webpack:///./client/components/CreateNote.js?f10c"],"names":["initState","content","mentions","parsedContent","color","rgb","hex","caretPos","displayColorPicker","hasJoined","flickState","dragStart","position","colorLocked","CreateNote","props","input","state","changeHandler","submitHandler","clickHandler","modalClickHandler","updateColor","toggleColorPicker","join","focusHandler","blurHandler","touchStartHandler","touchEndHandler","touchMoveHandler","parseContent","autoComplete","board","location","query","router","push","getBoard","clearSocketListeners","socketDisconnect","socketEmit","room","id","userId","user","queriedUsers","socketConnect","addSocketListener","setState","Object","keys","length","permissions","findIndex","permission","board_id","addUserPermission","name","first_name","last_name","prevState","assign","newState","Array","isArray","e","preventDefault","target","value","stopPropagation","focus","cb","currentTarget","focused","touches","pageY","dragPosition","viewportWidth","window","innerWidth","screen","width","Math","abs","setTimeout","innerHeight","height","createNote","then","selectionStart","users","currentWord","i","char","startIndex","tail","trimTail","slice","undefined","searchUsername","isMention","isSuggesting","find","replace","suggestedUsers","noteWrapperStyle","zIndex","transform","top","transition","hash","map","part","username","margin","background","console","log","str","match"],"mappings":";;;;;;;;;;;;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;;;;;AACA,KAAMA,YAAY;AAChBC,YAAoB,EADJ;AAEhBC,aAAoB,EAFJ;AAGhBC,kBAAoB,EAHJ;AAIhBC,UAAoB,gBAAMC,GAAN,CAAU,CAAE,GAAF,EAAO,GAAP,EAAY,EAAZ,CAAV,EAA4BC,GAA5B,EAJJ;AAKhBC,aAAoB,CALJ;AAMhBC,uBAAoB,KANJ;AAOhBC,cAAoB,KAPJ;AAQhBC,eAAoB,KARJ;AAShBC,cAAoB,IATJ;AAUhBC,aAAoB,CAVJ;AAWhBC,gBAAoB;AAXJ,EAAlB;;KAcqBC,U;;;AAEnB,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA,yHACXA,KADW;;AAGjB,WAAKC,KAAL,GAAa,EAAb;AACA,WAAKC,KAAL,GAAajB,SAAb;AACA,wCACE,MAAKkB,aADP,EAEE,MAAKC,aAFP,EAGE,MAAKC,YAHP,EAIE,MAAKC,iBAJP,EAKE,MAAKC,WALP,EAME,MAAKC,iBANP,EAOE,MAAKC,IAPP,EAQE,MAAKC,YARP,EASE,MAAKC,WATP,EAUE,MAAKC,iBAVP,EAWE,MAAKC,eAXP,EAYE,MAAKC,gBAZP,EAaE,MAAKC,YAbP,EAcE,MAAKC,YAdP;AALiB;AAqBlB;;;;0CAEoB;AACnB,WAAI,CAAC,CAAC,KAAKhB,KAAL,CAAWiB,KAAZ,IAAqB,uBAAQ,KAAKjB,KAAL,CAAWiB,KAAnB,CAAtB,KAAoD,CAAC,KAAKjB,KAAL,CAAWkB,QAAX,CAAoBC,KAApB,CAA0BF,KAAnF,EAA0F;AACxF;AACA;AACA,cAAKjB,KAAL,CAAWoB,MAAX,CAAkBC,IAAlB,CAAuB,WAAvB;AACD,QAJD,MAIO,IAAI,CAAC,KAAKrB,KAAL,CAAWiB,KAAZ,IAAqB,uBAAQ,KAAKjB,KAAL,CAAWiB,KAAnB,CAAzB,EAAoD;AACzD;AACA;AACA,cAAKjB,KAAL,CAAWsB,QAAX,CAAoB,KAAKtB,KAAL,CAAWkB,QAAX,CAAoBC,KAApB,CAA0BF,KAA9C;AACD;AACF;;;yCAEmB;AAClB;AACD;;;4CAEsB;AACrB;AACA,YAAKjB,KAAL,CAAWuB,oBAAX;AACA,YAAKvB,KAAL,CAAWwB,gBAAX;AACA,YAAKxB,KAAL,CAAWyB,UAAX,CAAsB,OAAtB,EAA+B;AAC7BC,eAAQ,8BAAa,KAAK1B,KAAL,CAAWiB,KAAX,CAAiBU,EAA9B,CADqB;AAE7BC,iBAAQ,KAAK5B,KAAL,CAAW6B,IAAX,CAAgBF;AAFK,QAA/B;AAID;;;qDAEsD;AAAA,WAA5BV,KAA4B,QAA5BA,KAA4B;AAAA,WAArBY,IAAqB,QAArBA,IAAqB;AAAA,WAAfC,YAAe,QAAfA,YAAe;;AACrD,WAAIb,SAASY,IAAT,IAAiB,CAAC,uBAAQZ,KAAR,CAAlB,IAAoC,CAAC,uBAAQY,IAAR,CAArC,IAAsD,CAAC,KAAK3B,KAAL,CAAWR,SAAtE,EAAiF;AAC/E,cAAKM,KAAL,CAAW+B,aAAX,CAAyB,OAAzB;AACA,cAAK/B,KAAL,CAAWgC,iBAAX,CAA6B,SAA7B,EAAwC,KAAKvB,IAA7C;AACA,cAAKwB,QAAL,CAAc,EAACvC,WAAW,IAAZ,EAAd;AACD;AACF;;;4BAEM;AAAA;;AACL,WAAIwC,OAAOC,IAAP,CAAY,KAAKnC,KAAL,CAAW6B,IAAvB,EAA6BO,MAAjC,EAAyC;AACvC,aAAI,KAAKpC,KAAL,CAAWqC,WAAX,CAAuBC,SAAvB,CAAiC,sBAAc;AACjD,kBAAOC,WAAWC,QAAX,KAAwB,OAAKxC,KAAL,CAAWiB,KAAX,CAAiBU,EAAhD;AACD,UAFG,MAEG,CAAC,CAFR,EAEW;AACT,gBAAK3B,KAAL,CAAWyC,iBAAX,CAA6B,KAAKzC,KAAL,CAAWiB,KAAxC;AACD;AACF;AACD,YAAKjB,KAAL,CAAWyB,UAAX,CAAsB,MAAtB,EAA8B;AAC5BC,eAAQ,8BAAa,KAAK1B,KAAL,CAAWiB,KAAX,CAAiBU,EAA9B,CADoB;AAE5Be,eAAQ,KAAK1C,KAAL,CAAW6B,IAAX,CAAgBc,UAAhB,GAA6B,GAA7B,GAAmC,KAAK3C,KAAL,CAAW6B,IAAX,CAAgBe,SAF/B;AAG5BhB,iBAAQ,KAAK5B,KAAL,CAAW6B,IAAX,CAAgBF;AAHI,QAA9B;AAKD;;;yCAEmB;AAClB,YAAKM,QAAL,CAAc,UAACY,SAAD,EAAe;AAC3B,gBAAOX,OAAOY,MAAP,CACL,EADK,EAELD,SAFK,EAGL,EAACpD,oBAAoB,CAACoD,UAAUpD,kBAAhC,EAHK,CAAP;AAID,QALD;AAMD;;;iCAEWJ,K,EAAO;AACjB,WAAM0D,WAAW,EAAjB;AACA,WAAI,OAAO1D,KAAP,KAAiB,QAArB,EAA+B0D,SAAS1D,KAAT,GAAiBA,KAAjB,CAA/B,KACK,IAAI2D,MAAMC,OAAN,CAAc5D,KAAd,CAAJ,EAA0B0D,SAAS1D,KAAT,GAAiB,gBAAMC,GAAN,CAAUD,KAAV,EAAiBE,GAAjB,EAAjB;AAC/B,YAAK0C,QAAL,CAAcc,QAAd;AACD;;;mCAEaG,C,EAAG;AACfA,SAAEC,cAAF;AACA,YAAKpC,YAAL,CAAkBmC,EAAEE,MAAF,CAASC,KAA3B;AACD;;;kCAEYH,C,EAAG;AACdA,SAAEC,cAAF;AACAD,SAAEI,eAAF;AACA,YAAKrD,KAAL,CAAWsD,KAAX;AACD;;;uCAEiBL,C,EAAGM,E,EAAI;AACvBN,SAAEI,eAAF;AACA,WAAIJ,EAAEE,MAAF,KAAaF,EAAEO,aAAnB,EAAkCD,GAAGN,CAAH;AACnC;;;oCAEc;;AAEb,YAAKjB,QAAL,CAAc,EAACyB,SAAS,IAAV,EAAd;AACD;;;mCAEa;AACZ,YAAKzB,QAAL,CAAc,EAACyB,SAAS,KAAV,EAAd;AACD;;;uCAEiBR,C,EAAG;AACnB,YAAKjB,QAAL,CAAc,EAACtC,YAAY,aAAb,EAA4BC,WAAWsD,EAAES,OAAF,CAAU,CAAV,EAAaC,KAApD,EAAd;AACD;;;sCAEgBV,C,EAAG;AAClB,WAAMW,eAAeX,EAAES,OAAF,CAAU,CAAV,EAAaC,KAAlC;AACA,WAAI,KAAK1D,KAAL,CAAWN,SAAX,IAAwBiE,eAAe,KAAK3D,KAAL,CAAWN,SAAtD,EAAiE;AAC/D,cAAKqC,QAAL,CAAc,EAAEpC,UAAUgE,eAAe,KAAK3D,KAAL,CAAWN,SAAtC,EAAd;AACD;AACF;;;qCAEesD,C,EAAG;AAAA;;AACjB,WAAMY,gBAAgBC,OAAOC,UAAP,GAAoBD,OAAOC,UAA3B,GAAwCD,OAAOE,MAAP,CAAcC,KAA5E;AACA,WAAIC,KAAKC,GAAL,CAAS,KAAKlE,KAAL,CAAWL,QAApB,IAAgCiE,gBAAgB,CAApD,EAAuD;AACrD,cAAK7B,QAAL,CAAc,EAACtC,YAAY,SAAb,EAAwBE,UAAU,CAACiE,aAAnC,EAAd;AACAO,oBAAW,YAAM;AACf,kBAAKjE,aAAL;AACD,UAFD,EAEG,GAFH;AAGD,QALD,MAKO,KAAK6B,QAAL,CAAc,EAACtC,YAAY,SAAb,EAAwBC,WAAW,IAAnC,EAAyCC,UAAU,CAAnD,EAAd;AACR;;;mCAEaqD,C,EAAG;AAAA;;AACf,WAAIA,CAAJ,EAAOA,EAAEC,cAAF;;AAEP,YAAKlB,QAAL,CAAc;AACZtC,qBAAY,aADA;AAEZE,mBAAYkE,OAAOO,WAAP,IAAsBP,OAAOE,MAAP,CAAcM;AAFpC,QAAd;AAIA,YAAKvE,KAAL,CAAWwE,UAAX,CAAsB;AACpBtF,kBAAU,KAAKgB,KAAL,CAAWhB,OADD;AAEpBG,gBAAU,KAAKa,KAAL,CAAWb,KAFD;AAGpBF,mBAAU,KAAKe,KAAL,CAAWf;AAHD,QAAtB,EAIG,KAAKa,KAAL,CAAWiB,KAAX,CAAiBU,EAJpB,EAKG8C,IALH,CAKQ,YAAM;AACV,aAAM1B,WAAW,EAACpD,YAAY,WAAb,EAA0BG,aAAa,OAAKI,KAAL,CAAWJ,WAAlD,EAAjB;AACA,aAAI,OAAKI,KAAL,CAAWJ,WAAf,EAA4BiD,SAAS1D,KAAT,GAAiB,OAAKa,KAAL,CAAWb,KAA5B;AAC5B,gBAAK4C,QAAL,CAAcC,OAAOY,MAAP,CAAc,EAAd,EAAkB7D,SAAlB,EAA6B8D,QAA7B,CAAd;AACD,QATH;AAUD;;;kCAEY7D,O,EAAS;AACpB,WAAMM,WAAW,KAAKS,KAAL,CAAWyE,cAA5B;AACA,WAAMC,QAAQ,KAAK3E,KAAL,CAAW8B,YAAzB;AACA,WAAM1C,gBAAgB,EAAtB;AACA,WAAIwF,cAAc,EAAlB;;AAEA,YAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAI3F,QAAQkD,MAA5B,EAAoCyC,GAApC,EAAyC;AACvC,aAAIC,OAAO5F,QAAQ2F,CAAR,CAAX;AACA,aAAME,aAAaF,CAAnB;;AAEA,aAAIC,SAAS,GAAb,EAAkB;AAChB,cAAG;AACDF,4BAAeE,IAAf;AACAD;AACAC,oBAAO5F,QAAQ2F,CAAR,CAAP;AACD,YAJD,QAISC,SAAS,GAAT,IAAgBD,IAAI3F,QAAQkD,MAJrC;AAKA,eAAM4C,OAAOC,SAASL,YAAYM,KAAZ,CAAkB,CAAlB,CAAT,CAAb;AACAN,yBAAcA,YAAYM,KAAZ,CAAkB,CAAlB,EAAqB,CAACF,KAAK5C,MAAN,IAAgB+C,SAArC,CAAd;;AAEA,eAAI3F,WAAWuF,UAAX,IAAyBvF,YAAYuF,aAAaH,YAAYxC,MAAlE,EAA0E;AACxE,kBAAKpC,KAAL,CAAWoF,cAAX,CAA0BR,YAAYM,KAAZ,CAAkB,CAAlB,CAA1B;AACA9F,2BAAciC,IAAd,CAAmB,EAACnC,SAAS0F,WAAV,EAAuBS,WAAW,IAAlC,EAAwCC,cAAc,IAAtD,EAAnB;AACD,YAHD,MAGO;AACLlG,2BAAciC,IAAd,CAAmB,EAACnC,SAAS0F,WAAV,EAAuBS,WAAW,IAAlC,EAAwCC,cAAc,KAAtD,EAAnB;AACD;AACDlG,yBAAciC,IAAd,CAAmB,EAACnC,SAAS8F,QAAQF,QAAQ,EAAhB,CAAV,EAAnB;AACD,UAhBD,MAgBO;AACLF,yBAAc,EAAd;AACAxF,yBAAciC,IAAd,CAAmB,EAACnC,SAAS4F,IAAV,EAAnB;AACD;AACF;;AAED,YAAK7C,QAAL,CAAc,EAAC/C,gBAAD,EAAUM,kBAAV,EAAoBJ,4BAApB,EAAd;AACD;;;kCAEYmG,I,EAAMC,O,EAAS7D,E,EAAI;AAC9B,WAAMzC,UAAU,KAAKgB,KAAL,CAAWhB,OAAX,CAAmBsG,OAAnB,CAA2BD,IAA3B,EAAiCC,OAAjC,CAAhB;AACA,YAAKvD,QAAL,CAAc,UAAC/B,KAAD,EAAW;AACvB,gBAAOgC,OAAOY,MAAP,CAAc,EAAd,EAAkB5C,KAAlB,EAAyB,EAACf,uCAAee,MAAMf,QAArB,IAA+BwC,EAA/B,EAAD,EAAzB,CAAP;AACD,QAFD;AAGA,YAAKZ,YAAL,CAAkB7B,OAAlB;AACD;;;8BAEQ;AAAA;;AAAA,WACAY,WADA,GACe,KAAKI,KADpB,CACAJ,WADA;;AAEP,WAAM2F,iBAAiB,KAAKzF,KAAL,CAAW8B,YAAlC;AACA,WAAM4D,mBAAmB,EAACC,QAAQ,CAAT,EAAzB;AACAD,wBAAiBE,SAAjB,eAAuC,KAAK1F,KAAL,CAAWL,QAAX,GAAsB,IAA7D;AACA6F,wBAAiBG,GAAjB,GAAuB,KAAK3F,KAAL,CAAWL,QAAlC;;AAEA,eAAQ,KAAKK,KAAL,CAAWP,UAAnB;AACA,cAAK,aAAL;AACE;AACF,cAAK,SAAL;AACE+F,4BAAiBI,UAAjB,GAA8B,kBAA9B;AACA;AACF,cAAK,WAAL;AACEJ,4BAAiBG,GAAjB,GAAuB,CAAvB;AACAH,4BAAiBI,UAAjB,GAA8B,uBAA9B;AACA;AACF;AACEJ,4BAAiBI,UAAjB,GAA8B,uBAA9B;AAXF;AAaA,WAAMzC,qBAAmB,KAAKrD,KAAL,CAAWiB,KAAX,CAAiB8E,IAA1C;;AAEA,cACE;AAAA;AAAA,WAAK,WAAU,WAAf;AACE;AAAA;AAAA,aAAM,iBAAe,KAAK/F,KAAL,CAAWiB,KAAX,CAAiB8E,IAAtC;AACA;AAAA;AAAA,eAAI,WAAU,oBAAd;AAAoC,kBAAK/F,KAAL,CAAWiB,KAAX,GAAmB,KAAKjB,KAAL,CAAWiB,KAAX,CAAiByB,IAApC,GAA2C;AAA/E;AADA,UADF;AAIE;AAAA;AAAA,aAAK,WAAU,KAAf;AACE;AAAA;AAAA,eAAK,WAAU,oDAAf;AACE;AAAA;AAAA,iBAAQ,SAAS,mBAAM;AAAE,0BAAKT,QAAL,CAAc,EAAC/C,SAAS,EAAV,EAAcE,eAAe,EAA7B,EAAd;AAAkD,kBAA3E,EAA6E,WAAU,mBAAvF;AAAA;AAAA,cADF;AAEE;AAAA;AAAA;AACE,4BAAU,wBADZ;AAEE,wBAAOsG,gBAFT;AAGE,0BAAS,CAAC,CAAC,KAAKzF,KAAP,IAAgB,KAAKI,YAHhC;AAIE,+BAAc,KAAKO,iBAJrB;AAKE,8BAAa,KAAKE,gBALpB;AAME,6BAAY,KAAKD,eANnB;AAOE;AAAA;AAAA;AACE,6BAAU,IADZ;AAEE,0BAAO,KAAKX,KAAL,CAAWb,KAFpB;AAGE;AAAA;AAAA;AACG,wBAAKa,KAAL,CAAWd,aAAX,CAAyB4G,GAAzB,CAA6B,gBAAQ;AACpC,yBAAIC,KAAKZ,SAAL,IAAkBY,KAAKX,YAA3B,EAAyC;AACvC,8BACE;AAAA;AAAA,2BAAM,WAAU,iCAAhB;AACGW,8BAAK/G,OADR;AAEE;AAAA;AAAA,6BAAI,WAAU,wBAAd;AACGuG,0CAAeO,GAAf,CAAmB,UAACnE,IAAD;AAAA,oCAClB;AAAA;AAAA;AACE;AAAA;AAAA,mCAAQ,SAAS;AAAA,4CAAM,OAAKb,YAAL,CAAkBiF,KAAK/G,OAAvB,EAAgC,MAAM2C,KAAKqE,QAA3C,EAAqDrE,KAAKF,EAA1D,CAAN;AAAA,oCAAjB;AAAA;AAAwFE,sCAAKqE;AAA7F;AADF,8BADkB;AAAA,4BAAnB;AADH;AAFF,wBADF;AAYD,sBAbD,MAaO,IAAID,KAAKZ,SAAT,EAAoB;AACzB,8BACE;AAAA;AAAA,2BAAM,WAAU,WAAhB;AACGY,8BAAK/G;AADR,wBADF;AAKD,sBANM,MAMA,OAAO+G,KAAK/G,OAAZ;AACR,oBArBA;AADH;AAHF,gBAPF;AAmCE,wDAAO,MAAK,MAAZ;AACE,wBAAO,KAAKgB,KAAL,CAAWhB,OADpB;AAEE,4BAAU,eAFZ;AAGE,sBAAK,aAACe,KAAD,EAAW;AAAE,0BAAKA,KAAL,GAAaA,KAAb;AAAqB,kBAHzC;AAIE,0BAAS,KAAKS,YAJhB;AAKE,yBAAQ,KAAKC,WALf;AAME,2BAAU,KAAKR,aANjB;AAnCF,cAFF;AA6CE;AAAA;AAAA,iBAAK,WAAU,UAAf,EAA0B,OAAO,EAACgG,QAAQ,aAAT,EAAjC;AACE;AACE,0BAAS,KAAK3F,iBADhB;AAEE,4BAAU,eAFZ;AAGE,wBAAO,EAAC4F,YAAY,KAAKlG,KAAL,CAAWb,KAAxB,EAHT,GADF;AAME;AAAA;AAAA,mBAAO,SAAQ,YAAf,EAA4B,4BAAyBS,cAAc,qBAAd,GAAsC,EAA/D,YAA5B;AAAA;AAAA,gBANF;AAOE,wDAAO,UAAU,oBAAM;AACrBuG,2BAAQC,GAAR,CAAY,6BAAZ,EAA2C,OAAKpG,KAAL,CAAWJ,WAAtD;AACA,0BAAKmC,QAAL,CAAc,EAACnC,aAAa,CAAC,OAAKI,KAAL,CAAWJ,WAA1B,EAAd;AACD,kBAHD,EAGG,IAAG,YAHN,EAGmB,WAAU,mBAH7B,EAGiD,MAAK,UAHtD,EAGiE,MAAK,YAHtE,EAGmF,SAASA,WAH5F;AAPF,cA7CF;AAyDE;AAAA;AAAA,iBAAK,WAAU,KAAf;AACE;AAAA;AAAA;AACE,4BAAS,KAAKM,aADhB;AAEE,8BAAU,uCAFZ;AAGE,0BAAO,EAAC8D,OAAO,KAAR,EAHT;AAAA;AAAA;AADF;AAzDF,YADF;AAmEI,gBAAKhE,KAAL,CAAWT,kBAAX,IACA;AAAA;AAAA;AACE;AAAA;AAAA,iBAAK,WAAU,wDAAf;AACE,0BAAS,iBAACyD,CAAD,EAAO;AAAE,0BAAK5C,iBAAL,CAAuB4C,CAAvB,EAA0B,OAAK1C,iBAA/B;AAAoD,kBADxE;AAEE;AACE,wBAAO,KAAKN,KAAL,CAAWb,KADpB;AAEE,8BAAa,KAAKkB,WAFpB;AAGE,gDAHF;AAIE,yBAAQ,KAAKC,iBAJf;AAFF;AADF;AApEJ;AAJF,QADF;AAuFD;;;;;;mBAnTkBT,U;;;AAsTrB,UAASkF,QAAT,CAAkBsB,GAAlB,EAAuB;AACrB,OAAIvB,OAAO,EAAX;;AAEA,QAAK,IAAIH,IAAI,CAAb,EAAgBA,IAAI0B,IAAInE,MAAxB,EAAgCyC,GAAhC,EAAqC;AACnC,SAAI0B,IAAI1B,CAAJ,EAAO2B,KAAP,CAAa,eAAb,CAAJ,EAAmC;AACjCxB,cAAOuB,IAAIrB,KAAJ,CAAUL,CAAV,CAAP;AACA;AACD;AACF;;AAED,UAAOG,IAAP;AACD,E","file":"0.eac9c2f91834a58e5fc2.hot-update.js","sourcesContent":["import React, {Component} from 'react';\nimport {Link} from 'react-router';\nimport isEmpty from 'lodash/isEmpty';\nimport bindHandlers from '../utils/bindHandlers';\nimport Note from './Note';\nimport ColorPicker from './ColorPicker';\nimport AutoSuggest from 'react-autosuggest';\nimport Color from 'color';\nimport {genShortHash} from '../utils/stringHash';\nimport presetColors from '../presetColors.json';\nconst initState = {\n  content           : '',\n  mentions          : [],\n  parsedContent     : [],\n  color             : Color.rgb([ 237, 208, 13 ]).hex(),\n  caretPos          : 0,\n  displayColorPicker: false,\n  hasJoined         : false,\n  flickState        : false,\n  dragStart         : null,\n  position          : 0,\n  colorLocked       : true\n};\n\nexport default class CreateNote extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.input = {};\n    this.state = initState;\n    bindHandlers(this,\n      this.changeHandler,\n      this.submitHandler,\n      this.clickHandler,\n      this.modalClickHandler,\n      this.updateColor,\n      this.toggleColorPicker,\n      this.join,\n      this.focusHandler,\n      this.blurHandler,\n      this.touchStartHandler,\n      this.touchEndHandler,\n      this.touchMoveHandler,\n      this.parseContent,\n      this.autoComplete\n    );\n  }\n\n  componentWillMount() {\n    if ((!this.props.board || isEmpty(this.props.board)) && !this.props.location.query.board) {\n      // If no board is selected and no board ID is provided\n      // redirect to myBoards page\n      this.props.router.push('/myboards');\n    } else if (!this.props.board || isEmpty(this.props.board)) {\n      // if no board is selected but a board ID is provided\n      // select board by ID\n      this.props.getBoard(this.props.location.query.board);\n    }\n  }\n\n  componentDidMount() {\n    // document.addEventListener('keyup', this.updateCursor);\n  }\n\n  componentWillUnmount() {\n    // document.removeEventListener('keyup', this.updateCursor);\n    this.props.clearSocketListeners();\n    this.props.socketDisconnect();\n    this.props.socketEmit('leave', {\n      room  : genShortHash(this.props.board.id),\n      userId: this.props.user.id\n    });\n  }\n\n  componentWillReceiveProps({board, user, queriedUsers}) {\n    if (board && user && !isEmpty(board) && !isEmpty(user) && !this.state.hasJoined) {\n      this.props.socketConnect('board');\n      this.props.addSocketListener('connect', this.join);\n      this.setState({hasJoined: true});\n    }\n  }\n\n  join() {\n    if (Object.keys(this.props.user).length) {\n      if (this.props.permissions.findIndex(permission => {\n        return permission.board_id === this.props.board.id;\n      }) === -1) {\n        this.props.addUserPermission(this.props.board);\n      }\n    }\n    this.props.socketEmit('join', {\n      room  : genShortHash(this.props.board.id),\n      name  : this.props.user.first_name + ' ' + this.props.user.last_name,\n      userId: this.props.user.id\n    });\n  }\n\n  toggleColorPicker() {\n    this.setState((prevState) => {\n      return Object.assign(\n        {},\n        prevState,\n        {displayColorPicker: !prevState.displayColorPicker});\n    });\n  }\n\n  updateColor(color) {\n    const newState = {};\n    if (typeof color === 'string') newState.color = color;\n    else if (Array.isArray(color)) newState.color = Color.rgb(color).hex();\n    this.setState(newState);\n  }\n\n  changeHandler(e) {\n    e.preventDefault();\n    this.parseContent(e.target.value);\n  }\n\n  clickHandler(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.input.focus();\n  }\n\n  modalClickHandler(e, cb) {\n    e.stopPropagation();\n    if (e.target === e.currentTarget) cb(e);\n  }\n\n  focusHandler() {\n\n    this.setState({focused: true});\n  }\n\n  blurHandler() {\n    this.setState({focused: false});\n  }\n\n  touchStartHandler(e) {\n    this.setState({flickState: 'positioning', dragStart: e.touches[0].pageY});\n  }\n\n  touchMoveHandler(e) {\n    const dragPosition = e.touches[0].pageY;\n    if (this.state.dragStart && dragPosition < this.state.dragStart) {\n      this.setState({ position: dragPosition - this.state.dragStart });\n    }\n  }\n\n  touchEndHandler(e) {\n    const viewportWidth = window.innerWidth ? window.innerWidth : window.screen.width;\n    if (Math.abs(this.state.position) > viewportWidth / 2) {\n      this.setState({flickState: 'sending', position: -viewportWidth});\n      setTimeout(() => {\n        this.submitHandler();\n      }, 100);\n    } else this.setState({flickState: 'resting', dragStart: null, position: 0});\n  }\n\n  submitHandler(e) {\n    if (e) e.preventDefault();\n\n    this.setState({\n      flickState: 'positioning',\n      position  : window.innerHeight || window.screen.height\n    });\n    this.props.createNote({\n      content : this.state.content,\n      color   : this.state.color,\n      mentions: this.state.mentions\n    }, this.props.board.id)\n      .then(() => {\n        const newState = {flickState: 'returning', colorLocked: this.state.colorLocked};\n        if (this.state.colorLocked) newState.color = this.state.color;\n        this.setState(Object.assign({}, initState, newState));\n      });\n  }\n\n  parseContent(content) {\n    const caretPos = this.input.selectionStart;\n    const users = this.props.queriedUsers;\n    const parsedContent = [];\n    let currentWord = '';\n\n    for (let i = 0; i < content.length; i++) {\n      let char = content[i];\n      const startIndex = i;\n\n      if (char === '@') {\n        do {\n          currentWord += char;\n          i++;\n          char = content[i];\n        } while (char !== ' ' && i < content.length);\n        const tail = trimTail(currentWord.slice(1));\n        currentWord = currentWord.slice(0, -tail.length || undefined);\n\n        if (caretPos > startIndex && caretPos <= startIndex + currentWord.length) {\n          this.props.searchUsername(currentWord.slice(1));\n          parsedContent.push({content: currentWord, isMention: true, isSuggesting: true});\n        } else {\n          parsedContent.push({content: currentWord, isMention: true, isSuggesting: false});\n        }\n        parsedContent.push({content: tail + (char || '')});\n      } else {\n        currentWord = '';\n        parsedContent.push({content: char});\n      }\n    }\n\n    this.setState({content, caretPos, parsedContent});\n  }\n\n  autoComplete(find, replace, id) {\n    const content = this.state.content.replace(find, replace);\n    this.setState((state) => {\n      return Object.assign({}, state, {mentions: [ ...state.mentions, id ]});\n    });\n    this.parseContent(content);\n  }\n\n  render() {\n    const {colorLocked} = this.state;\n    const suggestedUsers = this.props.queriedUsers;\n    const noteWrapperStyle = {zIndex: 1};\n    noteWrapperStyle.transform = `rotate(${this.state.position * 0.02}deg)`;\n    noteWrapperStyle.top = this.state.position;\n\n    switch (this.state.flickState) {\n    case 'positioning':\n      break;\n    case 'sending':\n      noteWrapperStyle.transition = 'all 0.1s ease-in';\n      break;\n    case 'returning':\n      noteWrapperStyle.top = 0;\n      noteWrapperStyle.transition = 'all 0.25s ease-in-out';\n      break;\n    default:\n      noteWrapperStyle.transition = 'all 0.25s ease-in-out';\n    }\n    const value = `/boards/${this.props.board.hash}`;\n\n    return (\n      <div className=\"container\">\n        <Link to={`/boards/${this.props.board.hash}`}>\n        <h1 className=\" boardTitle center\">{this.props.board ? this.props.board.name : ''}</h1>\n        </Link>\n        <div className=\"row\">\n          <div className=\"col-xs-10 col-xs-offset-1 col-md-4 col-md-offset-4\">\n            <button onClick={() => { this.setState({content: '', parsedContent: []}); }} className=\"c-note__clear-btn\">clear note</button>\n            <div\n              className=\"c-note---createwrapper\"\n              style={noteWrapperStyle}\n              onClick={!!this.input && this.clickHandler}\n              onTouchStart={this.touchStartHandler}\n              onTouchMove={this.touchMoveHandler}\n              onTouchEnd={this.touchEndHandler}>\n              <Note\n                editable={true}\n                color={this.state.color}>\n                <div>\n                  {this.state.parsedContent.map(part => {\n                    if (part.isMention && part.isSuggesting) {\n                      return (\n                        <span className=\"c-mention c-mention--suggesting\">\n                          {part.content}\n                          <ul className=\"c-mention__suggestions\">\n                            {suggestedUsers.map((user) => (\n                              <li>\n                                <button onClick={() => this.autoComplete(part.content, '@' + user.username, user.id)}>@{user.username}</button>\n                              </li>\n                            ))}\n                          </ul>\n                        </span>\n                      );\n                    } else if (part.isMention) {\n                      return (\n                        <span className=\"c-mention\">\n                          {part.content}\n                        </span>\n                      );\n                    } else return part.content;\n                  })}\n                </div>\n              </Note>\n              <input type=\"text\"\n                value={this.state.content}\n                className=\"c-note__input\"\n                ref={(input) => { this.input = input; }}\n                onFocus={this.focusHandler}\n                onBlur={this.blurHandler}\n                onChange={this.changeHandler} />\n            </div>\n            <div className=\"clearfix\" style={{margin: '0.25em auto'}}>\n              <button\n                onClick={this.toggleColorPicker}\n                className=\"btn btn-color\"\n                style={{background: this.state.color}}>\n              </button>\n              <label htmlFor=\"lock-color\" className={`c-checkbox ${colorLocked ? 'c-checkbox--checked' : ''} right`}>Lock Color</label>\n              <input onChange={() => {\n                console.log('SDFHGSFJHSDFGJAGSRHJSFDGJGF', this.state.colorLocked);\n                this.setState({colorLocked: !this.state.colorLocked});\n              }} id=\"lock-color\" className=\"c-checkbox__input\" type=\"checkbox\" name=\"lock-color\" checked={colorLocked}/>\n            </div>\n            <div className=\"row\">\n              <button\n                onClick={this.submitHandler}\n                className=\"btn btn-primary block ml-auto mr-auto\"\n                style={{width: '90%'}}>\n                Submit Note\n              </button>\n            </div>\n          </div>\n          { this.state.displayColorPicker &&\n            <div>\n              <div className=\"c-color-picker__wrapper c-color-picker__wrapper--modal\"\n                onClick={(e) => { this.modalClickHandler(e, this.toggleColorPicker); }}>\n                <ColorPicker\n                  color={this.state.color}\n                  updateColor={this.updateColor}\n                  presets={presetColors}\n                  toggle={this.toggleColorPicker} />\n              </div>\n            </div>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction trimTail(str) {\n  let tail = '';\n\n  for (let i = 0; i < str.length; i++) {\n    if (str[i].match(/[^A-Za-z0-9_]/)) {\n      tail = str.slice(i);\n      break;\n    }\n  }\n\n  return tail;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/components/CreateNote.js\n **/"],"sourceRoot":""}