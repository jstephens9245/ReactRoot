{"version":3,"sources":["webpack:///./client/components/CreateNote.js?f10c"],"names":["initState","content","color","rgb","hex","displayColorPicker","hasJoined","flickState","dragStart","position","CreateNote","props","state","changeHandler","submitHandler","clickHandler","modalClickHandler","updateColor","toggleColorPicker","join","focusHandler","blurHandler","touchStartHandler","touchEndHandler","touchMoveHandler","board","location","query","router","push","getBoard","clearSocketListeners","socketDisconnect","socketEmit","room","id","userId","user","socketConnect","addSocketListener","setState","Object","keys","length","permissions","findIndex","permission","board_id","addUserPermission","selectedBoard","name","first_name","last_name","prevState","assign","newState","Array","isArray","e","preventDefault","target","value","stopPropagation","input","focus","cb","currentTarget","focused","touches","pageY","dragPosition","viewportWidth","window","innerWidth","screen","width","Math","abs","setTimeout","innerHeight","height","createNote","then","noteWrapperStyle","zIndex","transform","top","transition","fontSize","margin","background"],"mappings":"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","file":"0.1c456c414fffeb5372bb.hot-update.js","sourcesContent":["import React, {Component} from 'react';\nimport isEmpty from 'lodash/isEmpty';\nimport bindHandlers from '../utils/bindHandlers';\nimport Note from './Note';\nimport ColorPicker from './ColorPicker';\nimport Color from 'color';\nimport {genShortHash} from '../utils/stringHash';\nimport presetColors from 'ROOT/client/presetColors.json';\nconst initState = {\n  content           : '',\n  color             : Color.rgb([ 237, 208, 13 ]).hex(),\n  displayColorPicker: false,\n  hasJoined         : false,\n  flickState        : false,\n  dragStart         : null,\n  position          : 0\n};\n\n\nexport default class CreateNote extends Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = initState;\n    bindHandlers(this,\n      this.changeHandler,\n      this.submitHandler,\n      this.clickHandler,\n      this.modalClickHandler,\n      this.updateColor,\n      this.toggleColorPicker,\n      this.join,\n      this.focusHandler,\n      this.blurHandler,\n      this.touchStartHandler,\n      this.touchEndHandler,\n      this.touchMoveHandler\n    );\n  }\n\n  componentWillMount() {\n    if ((!this.props.board || isEmpty(this.props.board)) && !this.props.location.query.board) {\n      // If no board is selected and no board ID is provided\n      // redirect to myBoards page\n      this.props.router.push('/myboards');\n    } else if (!this.props.board || isEmpty(this.props.board)) {\n      // if no board is selected but a board ID is provided\n      // select board by ID\n      this.props.getBoard(this.props.location.query.board);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.clearSocketListeners();\n    this.props.socketDisconnect();\n    this.props.socketEmit('leave', {\n      room  : genShortHash(this.props.board.id),\n      userId: this.props.user.id\n    });\n  }\n\n  componentWillReceiveProps({board, user}) {\n    if (board && user && !isEmpty(board) && !isEmpty(user) && !this.state.hasJoined) {\n      this.props.socketConnect('board');\n      this.props.addSocketListener('connect', this.join);\n      this.setState({hasJoined: true});\n    }\n  }\n\n  join() {\n    if (Object.keys(this.props.user).length) {\n      if (this.props.permissions.findIndex(permission => {\n        return permission.board_id === this.props.board.id; }) === -1) {\n        this.props.addUserPermission(this.props.selectedBoard);\n      }\n    }\n    this.props.socketEmit('join', {\n      room  : genShortHash(this.props.board.id),\n      name  : this.props.user.first_name + ' ' + this.props.user.last_name,\n      userId: this.props.user.id\n    });\n  }\n\n  toggleColorPicker() {\n    this.setState((prevState) => {\n      return Object.assign(\n        {},\n        prevState,\n        {displayColorPicker: !prevState.displayColorPicker});\n    });\n  }\n\n  updateColor(color) {\n    const newState = {};\n    if (typeof color === 'string') newState.color = color;\n    else if (Array.isArray(color)) newState.color = Color.rgb(color).hex();\n    this.setState(newState);\n  }\n\n  changeHandler(e) {\n    e.preventDefault();\n    this.setState({content: e.target.value});\n  }\n\n  clickHandler(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.input.focus();\n  }\n\n  modalClickHandler(e, cb) {\n    e.stopPropagation();\n    if (e.target === e.currentTarget) cb(e);\n  }\n\n  focusHandler() {\n\n    this.setState({focused: true});\n  }\n\n  blurHandler() {\n    this.setState({focused: false});\n  }\n\n  touchStartHandler(e) {\n    this.setState({flickState: 'positioning', dragStart: e.touches[0].pageY});\n  }\n\n  touchMoveHandler(e) {\n    const dragPosition = e.touches[0].pageY;\n    if (this.state.dragStart && dragPosition < this.state.dragStart) {\n      this.setState({ position: dragPosition - this.state.dragStart });\n    }\n  }\n\n  touchEndHandler(e) {\n    const viewportWidth = window.innerWidth ? window.innerWidth : window.screen.width;\n    if (Math.abs(this.state.position) > viewportWidth / 2) {\n      this.setState({flickState: 'sending', position: -viewportWidth});\n      setTimeout(() => {\n        this.submitHandler();\n      }, 100);\n    } else this.setState({flickState: 'resting', dragStart: null, position: 0});\n  }\n\n  submitHandler(e) {\n    if (e) e.preventDefault();\n\n    this.setState({flickState: 'positioning', position: window.innerHeight || window.screen.height});\n    this.props.createNote({\n      content: this.state.content,\n      color  : this.state.color\n    }, this.props.board.id)\n      .then(() => {\n        this.setState(Object.assign(initState, {flickState: 'returning'}));\n      });\n  }\n\n  render() {\n    const noteWrapperStyle = {zIndex: 1};\n    noteWrapperStyle.transform = `rotate(${this.state.position * 0.02}deg)`;\n    noteWrapperStyle.top = this.state.position;\n\n    switch (this.state.flickState) {\n    case 'positioning':\n      break;\n    case 'sending':\n      noteWrapperStyle.transition = 'all 0.1s ease-in';\n      break;\n    case 'returning':\n      noteWrapperStyle.top = 0;\n      noteWrapperStyle.transition = 'all 0.25s ease-in-out';\n      break;\n    default:\n      noteWrapperStyle.transition = 'all 0.25s ease-in-out';\n    }\n\n    return (\n      <div className=\"container\">\n        <h1 className=\"center\">{this.props.board ? this.props.board.name : ''}</h1>\n        <div className=\"row\">\n          <div className=\"col-xs-10 col-xs-offset-1\" style={{fontSize: '6vw'}}>\n            <div\n              style={noteWrapperStyle}\n              onClick={!!this.input && this.clickHandler}\n              onTouchStart={this.touchStartHandler}\n              onTouchMove={this.touchMoveHandler}\n              onTouchEnd={this.touchEndHandler}>\n              <Note\n                editable={true}\n                content={this.state.content}\n                color={this.state.color}\n                onChange={this.changeHandler}/>\n              <input type=\"text\"\n                value={this.state.content}\n                className=\"c-note__input\"\n                ref={(input) => { this.input = input; }}\n                onFocus={this.focusHandler}\n                onBlur={this.blurHandler}\n                onChange={this.changeHandler} />\n            </div>\n            <div style={{margin: '0.25em auto'}}>\n              <button\n                onClick={this.toggleColorPicker}\n                className=\"btn btn-color\"\n                style={{background: this.state.color}}>\n              </button>\n            </div>\n          </div>\n          { this.state.displayColorPicker &&\n            <div className=\"c-color-picker__wrapper c-color-picker__wrapper--modal\"\n              onClick={(e) => { this.modalClickHandler(e, this.toggleColorPicker); }}>\n              <ColorPicker\n                color={this.state.color}\n                updateColor={this.updateColor}\n                presets={presetColors} />\n            </div>\n          }\n        </div>\n        <div className=\"row\">\n          <button\n            onClick={this.submitHandler}\n            className=\"btn btn-primary block ml-auto mr-auto\">\n            Submit Note\n          </button>\n        </div>\n      </div>\n    );\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./client/components/CreateNote.js\n **/"],"sourceRoot":""}